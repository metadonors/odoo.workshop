<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.92.2" />
    
    <link rel="icon" href="/odoo.workshop/images/favicon.png" type="image/png">

    <title>Wizard :: Odoo Workshop</title>

    
    <link href="/odoo.workshop/css/nucleus.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/fontawesome-all.min.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/hybrid.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/featherlight.min.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/perfect-scrollbar.min.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/auto-complete.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/atom-one-dark-reasonable.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/theme.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/tabs.css?1666263210" rel="stylesheet">
    <link href="/odoo.workshop/css/hugo-theme.css?1666263210" rel="stylesheet">
    
    <link href="/odoo.workshop/css/theme-metadonors.css?1666263210" rel="stylesheet">
    
    

    <script src="/odoo.workshop/js/jquery-3.3.1.min.js?1666263210"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/odoo.workshop/application_logic/wizard/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/odoo.workshop">
    <img src="/odoo.workshop/images/logo.png"/>
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/odoo.workshop/js/lunr.min.js?1666263210"></script>
<script type="text/javascript" src="/odoo.workshop/js/auto-complete.js?1666263210"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/metadonors.github.io\/odoo.workshop\/";
    
</script>
<script type="text/javascript" src="/odoo.workshop/js/search.js?1666263210"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/odoo.workshop/basics/" title="Iniziare" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/basics/">
          <b>1. </b>Iniziare
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/basics/precorso/" title="Precorso" class="dd-item ">
        <a href="/odoo.workshop/basics/precorso/">
        Precorso
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/basics/installazione/" title="Installazione" class="dd-item ">
        <a href="/odoo.workshop/basics/installazione/">
        Installazione
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/basics/concetti/" title="Concetti Base" class="dd-item ">
        <a href="/odoo.workshop/basics/concetti/">
        Concetti Base
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/first_app/" title="La prima applicazione" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/first_app/">
          <b>2. </b>La prima applicazione
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/first_app/primo_modulo/" title="Scaffolding" class="dd-item ">
        <a href="/odoo.workshop/first_app/primo_modulo/">
        Scaffolding
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/first_app/primo_modello/" title="I modelli" class="dd-item ">
        <a href="/odoo.workshop/first_app/primo_modello/">
        I modelli
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/first_app/prime_viste/" title="Le viste" class="dd-item ">
        <a href="/odoo.workshop/first_app/prime_viste/">
        Le viste
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/first_app/prima_funzione/" title="La logica" class="dd-item ">
        <a href="/odoo.workshop/first_app/prima_funzione/">
        La logica
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/first_app/controllo_accessi/" title="Controllo Accessi" class="dd-item ">
        <a href="/odoo.workshop/first_app/controllo_accessi/">
        Controllo Accessi
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/inheritance/" title="Estendere i moduli" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/inheritance/">
          <b>3. </b>Estendere i moduli
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/inheritance/teoria/" title="Preambolo" class="dd-item ">
        <a href="/odoo.workshop/inheritance/teoria/">
        Preambolo
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/inheritance/estendere_modelli/" title="Estendere i Modelli" class="dd-item ">
        <a href="/odoo.workshop/inheritance/estendere_modelli/">
        Estendere i Modelli
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/inheritance/estendere_viste/" title="Estendere le Viste" class="dd-item ">
        <a href="/odoo.workshop/inheritance/estendere_viste/">
        Estendere le Viste
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/inheritance/estendere_dati/" title="Estendere i Dati" class="dd-item ">
        <a href="/odoo.workshop/inheritance/estendere_dati/">
        Estendere i Dati
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/inheritance/aggiungere_funzionalita/" title="Aggiungere funzionalità" class="dd-item ">
        <a href="/odoo.workshop/inheritance/aggiungere_funzionalita/">
        Aggiungere funzionalità
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/models/" title="I Modelli" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/models/">
          <b>4. </b>I Modelli
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/models/preambolo/" title="Preambolo" class="dd-item ">
        <a href="/odoo.workshop/models/preambolo/">
        Preambolo
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/models/campi_base/" title="Campi Base" class="dd-item ">
        <a href="/odoo.workshop/models/campi_base/">
        Campi Base
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/models/relazioni/" title="Relazioni" class="dd-item ">
        <a href="/odoo.workshop/models/relazioni/">
        Relazioni
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/models/computed_fields/" title="Computed Fields" class="dd-item ">
        <a href="/odoo.workshop/models/computed_fields/">
        Computed Fields
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/models/vincoli/" title="Vincoli" class="dd-item ">
        <a href="/odoo.workshop/models/vincoli/">
        Vincoli
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/views/" title="Le Viste" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/views/">
          <b>5. </b>Le Viste
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/menu_actions/" title="MenuItem e Actions" class="dd-item ">
        <a href="/odoo.workshop/views/menu_actions/">
        MenuItem e Actions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/context_domain/" title="Context e Domain" class="dd-item ">
        <a href="/odoo.workshop/views/context_domain/">
        Context e Domain
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/form_view/" title="Form View" class="dd-item ">
        <a href="/odoo.workshop/views/form_view/">
        Form View
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/list_view/" title="List e Search View" class="dd-item ">
        <a href="/odoo.workshop/views/list_view/">
        List e Search View
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/graph_pivot_views/" title="Pivot e Graph View" class="dd-item ">
        <a href="/odoo.workshop/views/graph_pivot_views/">
        Pivot e Graph View
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/views/altre_views/" title="Altre Viste" class="dd-item ">
        <a href="/odoo.workshop/views/altre_views/">
        Altre Viste
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/application_logic/" title="Logica applicativa" class="dd-item
        parent
        
        
        ">
      <a href="/odoo.workshop/application_logic/">
          <b>6. </b>Logica applicativa
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/application_logic/wizard/" title="Wizard" class="dd-item active">
        <a href="/odoo.workshop/application_logic/wizard/">
        Wizard
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/application_logic/usare_orm/" title="Usare l&#39;ORM" class="dd-item ">
        <a href="/odoo.workshop/application_logic/usare_orm/">
        Usare l&#39;ORM
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/api/" title="Api esterne" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/api/">
          <b>7. </b>Api esterne
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/api/panoramica/" title="Panoramica" class="dd-item ">
        <a href="/odoo.workshop/api/panoramica/">
        Panoramica
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odoo.workshop/api/operazioni/" title="Operazioni" class="dd-item ">
        <a href="/odoo.workshop/api/operazioni/">
        Operazioni
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/odoo.workshop/resources/" title="Altre Risorse" class="dd-item
        
        
        
        ">
      <a href="/odoo.workshop/resources/">
          <b>8. </b>Altre Risorse
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/metadonors/odoo.workshop/tree/master/content/application_logic/wizard.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/odoo.workshop/'>Index</a> > <a href='/odoo.workshop/application_logic/'>Logica applicativa</a> > Wizard
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#creare-un-wizard">Creare un wizard</a></li>
    <li><a href="#il-modello-del-wizard">Il modello del wizard</a></li>
    <li><a href="#la-vista-del-wizard">La vista del wizard</a></li>
    <li><a href="#la-logica-applicativa-del-wizard">La logica applicativa del wizard</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Wizard
            </h1>
          

        


<p>I wizard sono uno strumento molto utile per fornire agli utenti un interfaccia per effettuare operazioni complesse sui dati. Per esempio chiedendogli dati aggiuntivi rispetto alle operazioni che stanno facendo oppure semplicemente per avere uno strumento di validazione delle operazioni da effettuare.</p>
<h2 id="creare-un-wizard">Creare un wizard</h2>
<p>I wizard di solito risiedono nella cartella <em>wizards/</em> all&rsquo;interno dei moduli. Cominciamo a creare il nosto wizard nella cartella del modulo <em>todo_plus</em>
creando la seguente struttura</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">todo_plus/
    models/
        <span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
    security/
        <span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
    views/
        <span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
    <span style="color:#75715e"># Aggiungiamo questo</span>
    wizards/
        __init__.py
        todo_wizard.py
        todo_wizard.xml
    __init__.py
    __manifest__.py
</code></pre></div><p>All&rsquo;interno del file <em>todo_plus/__init.py__</em> aggiungiamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> wizards
</code></pre></div><p>All&rsquo;interno del file <em>todo_plus/wizards/__init.py__</em> aggiungiamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> todo_wizard
</code></pre></div><p>All&rsquo;interno del file <em>todo_plus/__manifest.py__</em> aggiungiamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">{
    <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;TODO Plus&#39;</span>,
    <span style="color:#e6db74">&#39;description&#39;</span>: <span style="color:#e6db74">&#34;Maggiori funzionalita per l&#39;app TODO&#34;</span>,
    <span style="color:#e6db74">&#39;author&#39;</span>: <span style="color:#e6db74">&#39;Metadonors&#39;</span>,
    <span style="color:#e6db74">&#39;depends&#39;</span>: [<span style="color:#e6db74">&#39;todo_user&#39;</span>],
    <span style="color:#e6db74">&#39;data&#39;</span>: [
        <span style="color:#e6db74">&#39;security/todo_project_acl.xml&#39;</span>,
        <span style="color:#e6db74">&#39;security/todo_tag_acl.xml&#39;</span>,
        <span style="color:#e6db74">&#39;views/todo_task.xml&#39;</span>,
        <span style="color:#e6db74">&#39;views/todo_project.xml&#39;</span>,
        <span style="color:#e6db74">&#39;wizards/todo_wizard.xml&#39;</span> <span style="color:#75715e"># &lt;--- Aggiungiamo questo</span>
    ]
}
</code></pre></div><h2 id="il-modello-del-wizard">Il modello del wizard</h2>
<p>Un wizard visualizza una Form View all&rsquo;utente, solitamente all&rsquo;interno di una finestra modale. Questa vista è implementata con la stessa architattura che abbiamo visto finora con l&rsquo;unica differenza che il modello del wizard erediterà dalla classe <em>models.TransientModel</em> anzichè dalla classe <em>models.Models</em>. Questo tipo di modelli vengono salvati in database come i modelli classici con l&rsquo;unica differenza che vengono automaticamente cancellati ogni giorno.</p>
<p>Quindi apriamo il file <em>todo_plus/wizards/todo_wizard.py</em> e scriviamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
<span style="color:#f92672">from</span> odoo <span style="color:#f92672">import</span> models, fields, api

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TodoWizard</span>(models<span style="color:#f92672">.</span>TransientModel):
    _name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;todo.wizard&#39;</span>
    _desctiption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Todo Wizard per assegnazioni massive&#39;</span>

    todo_ids <span style="color:#f92672">=</span> fields<span style="color:#f92672">.</span>Many2many(<span style="color:#e6db74">&#39;todo.task&#39;</span>, string<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Tasks&#39;</span>)
    new_deadline_date <span style="color:#f92672">=</span> fields<span style="color:#f92672">.</span>Date(string<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Nuova deadline&#39;</span>)
    new_user_id <span style="color:#f92672">=</span> fields<span style="color:#f92672">.</span>Many2one(<span style="color:#e6db74">&#39;res.users&#39;</span>, string<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Nuovo Responsabile&#39;</span>)
</code></pre></div><h2 id="la-vista-del-wizard">La vista del wizard</h2>
<p>Le viste dei wizard sono uguali alle viste classiche, con due differenze:</p>
<ul>
<li>Può essere inserita una sezione &lt;footer&gt; per contenere i pulsanti del wizard</li>
<li>Può essere inserito un pulsante con <em>special=&ldquo;cancel&rdquo;</em> che si ooccupa di chiudere il wizard</li>
</ul>
<p>Quindi apriamo il file <em>todo_plus/wizards/todo_wizard.xml</em> e scriviamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;odoo&gt;</span>
    <span style="color:#f92672">&lt;record</span> <span style="color:#a6e22e">model=</span><span style="color:#e6db74">&#34;ir.ui.view&#34;</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;todo_task_wizard_view&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">&gt;</span>todo.wizard.form<span style="color:#f92672">&lt;/field&gt;</span>
        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;model&#34;</span><span style="color:#f92672">&gt;</span>todo.wizard<span style="color:#f92672">&lt;/field&gt;</span>
        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;arch&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;xml&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;form&gt;</span>
                <span style="color:#f92672">&lt;div</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;oe_right&#34;</span><span style="color:#f92672">&gt;</span>
                    <span style="color:#f92672">&lt;button</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;object&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;do_count_todos&#34;</span> <span style="color:#a6e22e">string=</span><span style="color:#e6db74">&#34;Conta&#34;</span><span style="color:#f92672">/&gt;</span>
                    <span style="color:#f92672">&lt;button</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;object&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;do_select_all&#34;</span> <span style="color:#a6e22e">string=</span><span style="color:#e6db74">&#34;Seleziona tutti&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;/div&gt;</span>

                <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;todo_ids&#34;</span><span style="color:#f92672">&gt;</span>
                    <span style="color:#f92672">&lt;tree&gt;</span>
                        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">/&gt;</span>
                        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;user_id&#34;</span><span style="color:#f92672">/&gt;</span>
                        <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;deadline_date&#34;</span><span style="color:#f92672">/&gt;</span>
                    <span style="color:#f92672">&lt;/tree&gt;</span>
                <span style="color:#f92672">&lt;/field&gt;</span>

                <span style="color:#f92672">&lt;group&gt;</span>
                    <span style="color:#f92672">&lt;group&gt;</span> <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;new_user_id&#34;</span><span style="color:#f92672">/&gt;&lt;/group&gt;</span>   
                    <span style="color:#f92672">&lt;group&gt;</span> <span style="color:#f92672">&lt;field</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;new_deadline_date&#34;</span><span style="color:#f92672">/&gt;&lt;/group&gt;</span>   
                <span style="color:#f92672">&lt;/group&gt;</span>

                <span style="color:#f92672">&lt;footer&gt;</span>
                    <span style="color:#f92672">&lt;button</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;object&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;do_mass_update&#34;</span> <span style="color:#a6e22e">string=</span><span style="color:#e6db74">&#34;Riassegna&#34;</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;oe_highlight&#34;</span>
                            <span style="color:#a6e22e">attrs=</span><span style="color:#e6db74">&#34;{&#39;invisible&#39;:[(&#39;new_user_id&#39;, &#39;=&#39;, False)]}&#34;</span><span style="color:#f92672">/&gt;</span>
                    <span style="color:#f92672">&lt;button</span> <span style="color:#a6e22e">special=</span><span style="color:#e6db74">&#34;cancel&#34;</span> <span style="color:#a6e22e">string=</span><span style="color:#e6db74">&#34;Annulla&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;/footer&gt;</span>
            <span style="color:#f92672">&lt;/form&gt;</span>
        <span style="color:#f92672">&lt;/field&gt;</span>
    <span style="color:#f92672">&lt;/record&gt;</span>

    <span style="color:#f92672">&lt;act_window</span> 
        <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;todo_app.action_todo_wizard&#34;</span> 
        <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Todo Wizard&#34;</span> 
        <span style="color:#a6e22e">src_model=</span><span style="color:#e6db74">&#34;todo.task&#34;</span> 
        <span style="color:#a6e22e">res_model=</span><span style="color:#e6db74">&#34;todo.wizard&#34;</span> 
        <span style="color:#a6e22e">view_mode=</span><span style="color:#e6db74">&#34;form&#34;</span> 
        <span style="color:#a6e22e">target=</span><span style="color:#e6db74">&#34;new&#34;</span> 
        <span style="color:#a6e22e">multi=</span><span style="color:#e6db74">&#34;True&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/odoo&gt;</span>

</code></pre></div><pre tabindex="0"><code>    $ docker-compose run odoo upgrade todo_user
</code></pre><p>ricaricare la pagine nel nostro browser e dalla lista dei todo selezioniamo qualche check box. Apparirà il menu <em>Action</em> al cui interno ci sarà il sottomenu <em>Todo Wizard</em>. Premendo si dovrebbe aprire il nostro wizard</p>
<p><img src="/odoo.workshop/screen/wizards/form.png?width=60pc" alt="form"></p>
<h2 id="la-logica-applicativa-del-wizard">La logica applicativa del wizard</h2>
<p>A questo punto non ci rimane che implementare la logica dietro il nostro wizard. Escluso il tasto cancel, abbiamo tre pulsanti che devono essere programmati. Cominciamo con il tasto principale <em>Riassegna</em></p>
<p>Il metodo chiamato dal pulsante è <em>do_mass_update</em> e, come gli altri, dovrà essere definito nel modello</p>
<p>Quindi apriamo il file <em>todo_plus/wizards/todo_wizard.py</em> e aggiungiamo in cima al file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> odoo <span style="color:#f92672">import</span> exceptions

<span style="color:#f92672">import</span> logging
log <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger(__name__)
</code></pre></div><p>nel corpo della classe invece aggiungiamo</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@api</span><span style="color:#f92672">.</span>multi
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">do_mass_update</span>(self):
    self<span style="color:#f92672">.</span>ensure_one()

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> self<span style="color:#f92672">.</span>new_user_id:
        <span style="color:#66d9ef">raise</span> exceptions<span style="color:#f92672">.</span>ValidationError(<span style="color:#e6db74">&#34;E&#39; necessario specificare un utente&#34;</span>)
    
    log<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;Mass update on todos </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>todo_ids<span style="color:#f92672">.</span>ids)

    vals <span style="color:#f92672">=</span> {}

    <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>new_deadline_date:
        vals[<span style="color:#e6db74">&#39;deadline_date&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>new_deadline_date
    
    vals[<span style="color:#e6db74">&#39;user_id&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>new_user_id<span style="color:#f92672">.</span>id

    self<span style="color:#f92672">.</span>todo_ids<span style="color:#f92672">.</span>write(vals)
    
</code></pre></div><p>Questo metodo solleva un errore se l&rsquo;utente cerca di inviare il form senza specificare un responsabile da assegnare ai todo selezionati.</p>
<p>Ora vediamo come implementare il conteggio dei task aperti, aggiungiamo sempre nel corpo della modello del wizard:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@api</span><span style="color:#f92672">.</span>multi
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">do_count_todos</span>(self):
    count <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>env[<span style="color:#e6db74">&#39;todo.task&#39;</span>]<span style="color:#f92672">.</span>search_count([(<span style="color:#e6db74">&#39;is_done&#39;</span>, <span style="color:#e6db74">&#39;=&#39;</span>, <span style="color:#66d9ef">False</span>)])
    <span style="color:#66d9ef">raise</span> exceptions<span style="color:#f92672">.</span>Warning(<span style="color:#e6db74">&#34;Ci sono </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> todo ancora aperti&#34;</span> <span style="color:#f92672">%</span> count)
</code></pre></div><p>per l&rsquo;ultimo metodo (Seleziona tutti) invece c&rsquo;è un piccolo problema: ogni volta che premiamo un bottone in un wizard e la chiamata non ritorna un eccezione, Oddo chiude automaticamente la finestra popup. La soluzione a questo è qquella di restituire un&rsquo;azione che dice ad odoo di riaprire il wizard, vediamo come:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#a6e22e">@api</span><span style="color:#f92672">.</span>multi
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_reopen_wizard</span>(self):
    self<span style="color:#f92672">.</span>ensure_one()

    <span style="color:#75715e"># restituiamo un dizionario rappresentate l&#39;action che riaprira&#39; questo wizard</span>
    <span style="color:#66d9ef">return</span> {
        <span style="color:#e6db74">&#39;type&#39;</span>: <span style="color:#e6db74">&#39;ir.actions.act_window&#39;</span>,
        <span style="color:#e6db74">&#39;res_model&#39;</span>: self<span style="color:#f92672">.</span>_name, <span style="color:#75715e"># questo modello</span>
        <span style="color:#e6db74">&#39;res_id&#39;</span>: self<span style="color:#f92672">.</span>id, <span style="color:#75715e"># l&#39;id del wizard corrente</span>
        <span style="color:#e6db74">&#39;view_type&#39;</span>: <span style="color:#e6db74">&#39;form&#39;</span>,
        <span style="color:#e6db74">&#39;view_mode&#39;</span>: <span style="color:#e6db74">&#39;form&#39;</span>,
        <span style="color:#e6db74">&#39;target&#39;</span>: <span style="color:#e6db74">&#39;new&#39;</span>
    }

<span style="color:#a6e22e">@api</span><span style="color:#f92672">.</span>multi
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">do_select_all</span>(self):
    self<span style="color:#f92672">.</span>ensure_one()

    open_todos <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>env[<span style="color:#e6db74">&#39;todo.task&#39;</span>]<span style="color:#f92672">.</span>search([
        (<span style="color:#e6db74">&#39;is_done&#39;</span>, <span style="color:#e6db74">&#39;=&#39;</span>, <span style="color:#66d9ef">False</span>)
    ])

    self<span style="color:#f92672">.</span>todo_ids <span style="color:#f92672">=</span> open_todos

    <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_reopen_wizard()

</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/odoo.workshop/application_logic/" title="Logica applicativa"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/odoo.workshop/application_logic/usare_orm/" title="Usare l&#39;ORM" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/odoo.workshop/js/clipboard.min.js?1666263210"></script>
    <script src="/odoo.workshop/js/perfect-scrollbar.min.js?1666263210"></script>
    <script src="/odoo.workshop/js/perfect-scrollbar.jquery.min.js?1666263210"></script>
    <script src="/odoo.workshop/js/jquery.sticky.js?1666263210"></script>
    <script src="/odoo.workshop/js/featherlight.min.js?1666263210"></script>
    <script src="/odoo.workshop/js/highlight.pack.js?1666263210"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/odoo.workshop/js/modernizr.custom-3.6.0.js?1666263210"></script>
    <script src="/odoo.workshop/js/learn.js?1666263210"></script>
    <script src="/odoo.workshop/js/hugo-learn.js?1666263210"></script>
    
        
            <script src="/odoo.workshop/mermaid/mermaid.js?1666263210"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

